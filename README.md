# Notes Application - Markdown Editor

Полнофункциональное desktop-приложение для заметок на Python + PyQt6 с поддержкой Markdown.

## Архитектурные принципы

- **Markdown - единственный канонический формат хранения заметок**
- HTML не используется ни для хранения, ни как промежуточный формат
- Любое форматирование обратимо без деградации Markdown

## Возможности

### Редактор

- **Визуальное форматирование** через toolbar:
  - Bold (**)
  - Italic (*)
  - Heading (H1–H3 через #)
  - Bullet list (-)
  - Quote (>)
  - Inline code (`)

- **Два режима работы**:
  1. **Visual Markdown mode**: визуальное представление с форматированием
  2. **Raw Markdown mode**: чистый markdown-текст без визуальных элементов

- Переключение режимов **НЕ меняет** содержимое markdown-текста

### Хранение

- Локальное хранение через SQLite
- Каждая заметка содержит:
  - `id`
  - `title`
  - `markdown_content` (TEXT) - **только Markdown**
  - `created_at`
  - `updated_at`

### Синхронизация

- Настройка размера шрифта (применяется ко всем элементам интерфейса)
- Поддержка понятий:
  - **Safe Markdown**: заголовки, жирный, курсив, простые списки (поддерживается большинством сервисов)
  - **Extended Markdown**: код, таблицы, сложные конструкции (может теряться при синхронизации)
- При синхронизации:
  - Либо понижение форматирования до safe-уровня
  - Либо предупреждение пользователя
- Оригинальный markdown всегда сохраняется локально без изменений

## Установка и запуск

### Требования

- Python 3.8+
- PyQt6
- Ubuntu (или другая Linux система)

### Установка зависимостей

```bash
# Создайте виртуальное окружение (рекомендуется)
python3 -m venv venv
source venv/bin/activate

# Установите зависимости
pip install -r requirements.txt
```

**Примечание**: QMarkdownTextEdit не является стандартным пакетом. Приложение использует встроенную поддержку Markdown в PyQt6 QTextEdit через методы `setMarkdown()` и `toMarkdown()`. Если требуется использовать библиотеку QMarkdownTextEdit от pbek, установите её вручную из [репозитория](https://github.com/pbek/QMarkdownTextEdit).

### Запуск

```bash
python3 main.py
```

Или используйте скрипт:

```bash
./run.sh
```

## Структура проекта

```
notes-google-keep/
├── main.py                 # Точка входа
├── gui.py                  # GUI слой (PyQt6)
├── editor.py               # Логика редактора (Visual/Raw режимы)
├── models.py               # Модели данных (Note)
├── database.py             # Database layer (SQLite)
├── sync_manager.py         # Sync layer (Safe/Extended Markdown)
├── settings.py             # Управление настройками
├── themes.py               # Темы оформления
├── settings_dialog.py      # Диалог настроек
├── sync_settings_dialog.py # Диалог настроек синхронизации
├── google_keep_sync.py     # Синхронизация с Google Keep
└── requirements.txt        # Зависимости
```

## Архитектура

### Разделение слоев

- **GUI**: `gui.py` - интерфейс пользователя
- **Editor logic**: `editor.py` - логика редактора с двумя режимами
- **Database layer**: `database.py` - работа с SQLite
- **Sync layer**: `sync_manager.py` - синхронизация с поддержкой Safe/Extended Markdown

### Классы

- `Note`: модель заметки (dataclass)
- `DatabaseManager`: управление базой данных
- `MarkdownEditor`: управление редактором (Visual/Raw режимы)
- `SyncManager`: синхронизация заметок
- `MarkdownLevel`: определение Safe/Extended Markdown

## Использование

1. **Создание заметки**: Нажмите кнопку "+" или используйте Ctrl+N
2. **Редактирование**: Выберите заметку из списка и начните редактировать
3. **Форматирование**: Используйте кнопки на toolbar для применения форматирования
4. **Переключение режимов**: Нажмите кнопку "Visual"/"Raw" для переключения между визуальным и текстовым режимами
5. **Автосохранение**: Заметки сохраняются автоматически через 1 секунду после изменения
6. **Синхронизация**: Используйте меню "Файл" → "Синхронизировать" или настройте синхронизацию в "Настройки" → "Синхронизация"

## Лицензия

MIT
